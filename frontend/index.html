<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Wars API Explorer</title>
    <link href="https://fonts.cdnfonts.com/css/star-wars" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --sw-yellow: #FFE81F;
            --sw-blue: #2E67F8;
            --dark-bg: #050505;
            --card-bg: rgba(20, 20, 20, 0.9);
            --input-bg: #151515;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--dark-bg);
            color: #ffffff;
            font-family: 'Roboto', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            /* Estrelas menores e coloridas */
            background-image: 
                radial-gradient(1px 1px at 25px 35px, #fff, rgba(0,0,0,0)),
                radial-gradient(1.2px 1.2px at 50px 80px, var(--sw-blue), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 90px 45px, var(--sw-yellow), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 150px 100px, #ff4444, rgba(0,0,0,0));
            background-size: 250px 250px;
            animation: stars-animation 200s linear infinite;
        }

        @keyframes stars-animation {
            from { background-position: 0 0; }
            to { background-position: 1000px 1000px; }
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-family: 'Star Wars', sans-serif;
            font-size: 3.5em;
            color: var(--sw-yellow);
            text-shadow: 0 0 20px rgba(255, 232, 31, 0.4);
            letter-spacing: 4px;
        }

        .subtitle {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-top: 10px;
        }

        /* Painel de Busca - Amarelo */
        .search-panel {
            background: var(--card-bg);
            border: 2px solid var(--sw-yellow);
            padding: 30px;
            margin-bottom: 35px;
            border-radius: 8px;
            clip-path: polygon(3% 0, 97% 0, 100% 15%, 100% 85%, 97% 100%, 3% 100%, 0 85%, 0 15%);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.7rem;
            color: var(--sw-yellow);
            margin-bottom: 8px;
            text-transform: uppercase;
            font-weight: bold;
        }

        select, input {
            padding: 12px;
            background: var(--input-bg);
            border: 1px solid #333;
            color: white;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--sw-yellow);
            box-shadow: 0 0 8px rgba(255, 232, 31, 0.3);
        }

        button {
            grid-column: 1 / -1;
            margin: 20px auto 0;
            background: var(--sw-yellow);
            color: #000;
            border: none;
            padding: 12px 60px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px var(--sw-yellow);
        }

        /* Container de Resultados - Azul */
        .results-container {
            background: var(--card-bg);
            border: 2px solid var(--sw-blue);
            padding: 30px;
            border-radius: 8px;
            min-height: 300px;
            clip-path: polygon(0 0, 100% 0, 100% 95%, 98% 100%, 2% 100%, 0 95%);
        }

        .info-bar {
            display: flex;
            justify-content: space-between;
            color: var(--sw-blue);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.75rem;
            margin-bottom: 25px;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        /* Card Individual */
        .result-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid #222;
            border-left: 4px solid var(--sw-blue);
            padding: 20px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .result-card:hover {
            background: rgba(255, 255, 255, 0.07);
            border-color: var(--sw-blue);
        }

        .result-card h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--sw-yellow);
            font-size: 1rem;
            margin-bottom: 12px;
            letter-spacing: 1px;
        }

        .result-card p {
            font-size: 0.85rem;
            margin: 6px 0;
            color: #ddd;
            display: flex;
            justify-content: space-between;
        }

        .result-card strong {
            color: var(--sw-blue);
            font-weight: 400;
            text-transform: uppercase;
            font-size: 0.7rem;
            margin-right: 10px;
        }

        /* Paginação */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 30px;
        }

        .pagination button {
            padding: 8px 20px;
            background: transparent;
            border: 1px solid var(--sw-blue);
            color: var(--sw-blue);
            border-radius: 4px;
            font-size: 0.7rem;
        }

        footer {
            text-align: center;
            margin: 60px 0;
            font-family: 'Orbitron', sans-serif;
            color: #666;
            font-size: 1rem;
            letter-spacing: 2px;
        }

        .loading {
            text-align: center;
            font-family: 'Orbitron', sans-serif;
            color: var(--sw-yellow);
            padding: 50px;
        }

        @media (max-width: 600px) {
            h1 { font-size: 2.2em; }
            .search-panel, .results-container { clip-path: none; padding: 20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>STAR WARS</h1>
            <p class="subtitle">Explorador de Arquivos Galácticos</p>
        </header>

        <div class="search-panel">
            <form id="searchForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="tipo">Tipo de Recurso</label>
                        <select id="tipo" name="tipo" required>
                            <option value="">Selecione...</option>
                            <option value="people">Personagens</option>
                            <option value="planets">Planetas</option>
                            <option value="starships">Naves Espaciais</option>
                            <option value="films">Filmes</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="termo">Buscar (opcional)</label>
                        <input type="text" id="termo" name="termo" placeholder="Ex: Skywalker, Tatooine...">
                    </div>

                    <div class="form-group">
                        <label for="ordenar_por">Ordenar por</label>
                        <select id="ordenar_por" name="ordenar_por">
                            <option value="">Padrão</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="ordem">Ordem</label>
                        <select id="ordem" name="ordem">
                            <option value="asc">Crescente</option>
                            <option value="desc">Decrescente</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="limite">Itens por página</label>
                        <input type="number" id="limite" name="limite" value="10" min="1" max="100">
                    </div>
                </div>
                <button type="submit">Iniciar Escaneamento</button>
            </form>
        </div>

        <div class="results-container">
            <div id="loading" class="loading" style="display: none;">Conectando à Holonet...</div>
            <div id="error" style="display: none; color: #ff4444; text-align: center; padding: 20px;"></div>
            <div id="results"></div>
        </div>

        <footer>
            Augusto Saboia Galaxy
        </footer>
    </div>

    <script>
        const API_BASE_URL = 'https://starwars-gateway-7mwhqkjo.uc.gateway.dev/'; 
        
        const sortFields = {
            people: [
                { value: 'name', label: 'Nome' },
                { value: 'height', label: 'Altura' },
                { value: 'mass', label: 'Peso' },
                { value: 'birth_year', label: 'Ano de Nascimento' }
            ],
            planets: [
                { value: 'name', label: 'Nome' },
                { value: 'diameter', label: 'Diâmetro' },
                { value: 'population', label: 'População' }
            ],
            starships: [
                { value: 'name', label: 'Nome' },
                { value: 'length', label: 'Comprimento' },
                { value: 'crew', label: 'Tripulação' }
            ],
            films: [
                { value: 'title', label: 'Título' },
                { value: 'episode_id', label: 'Episódio' },
                { value: 'release_date', label: 'Lançamento' }
            ]
        };

        let currentPage = 1;

        document.getElementById('tipo').addEventListener('change', function() {
            const tipo = this.value;
            const ordenarPor = document.getElementById('ordenar_por');
            ordenarPor.innerHTML = '<option value="">Padrão</option>';
            if (tipo && sortFields[tipo]) {
                sortFields[tipo].forEach(field => {
                    const option = document.createElement('option');
                    option.value = field.value;
                    option.textContent = field.label;
                    ordenarPor.appendChild(option);
                });
            }
        });

        document.getElementById('searchForm').addEventListener('submit', function(e) {
            e.preventDefault();
            currentPage = 1;
            search();
        });

        async function search() {
            const tipo = document.getElementById('tipo').value;
            const termo = document.getElementById('termo').value;
            const ordenarPor = document.getElementById('ordenar_por').value;
            const ordem = document.getElementById('ordem').value;
            const limite = document.getElementById('limite').value;

            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').innerHTML = '';
            document.getElementById('error').style.display = 'none';

            try {
                const params = new URLSearchParams({ tipo, pagina: currentPage, limite });
                if (termo) params.append('termo', termo);
                if (ordenarPor) params.append('ordenar_por', ordenarPor);
                if (ordem) params.append('ordem', ordem);

                const response = await fetch(`${API_BASE_URL}/explorar?${params}`);
                const data = await response.json();
                if (!response.ok) throw new Error(data.erro || 'Falha na conexão');
                displayResults(data);
            } catch (error) {
                document.getElementById('error').textContent = `ERRO DE TRANSMISSÃO: ${error.message}`;
                document.getElementById('error').style.display = 'block';
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            if (!data.resultados || data.resultados.length === 0) {
                resultsDiv.innerHTML = '<div style="text-align:center; padding: 40px;"><h2>ARQUIVO NÃO ENCONTRADO</h2></div>';
                return;
            }

            let html = `
                <div class="info-bar">
                    <span>ENCONTRADOS: ${data.total_encontrado}</span>
                    <span>PÁGINA: ${data.pagina_atual} / ${data.total_paginas}</span>
                </div>
                <div class="results-grid">
            `;

            data.resultados.forEach(item => {
                html += createCard(item, data.categoria);
            });

            html += '</div>';
            if (data.total_paginas > 1) html += createPagination(data);
            resultsDiv.innerHTML = html;
        }

        function createCard(item, categoria) {
            let content = `<div class="result-card"><h3>${item.name || item.title}</h3>`;
            
            if (categoria === 'people') {
                content += `
                    <p><strong>Altura</strong> <span>${item.height} cm</span></p>
                    <p><strong>Peso</strong> <span>${item.mass} kg</span></p>
                    <p><strong>Gênero</strong> <span>${item.gender}</span></p>
                    <p><strong>Nascimento</strong> <span>${item.birth_year}</span></p>
                    <p><strong>Olhos</strong> <span>${item.eye_color}</span></p>
                `;
            } else if (categoria === 'planets') {
                content += `
                    <p><strong>Clima</strong> <span>${item.climate}</span></p>
                    <p><strong>Terreno</strong> <span>${item.terrain}</span></p>
                    <p><strong>População</strong> <span>${item.population}</span></p>
                    <p><strong>Diâmetro</strong> <span>${item.diameter} km</span></p>
                `;
            } else if (categoria === 'starships') {
                content += `
                    <p><strong>Modelo</strong> <span>${item.model}</span></p>
                    <p><strong>Tripulação</strong> <span>${item.crew}</span></p>
                    <p><strong>Passageiros</strong> <span>${item.passengers}</span></p>
                    <p><strong>Custo</strong> <span>${item.cost_in_credits}</span></p>
                `;
            } else if (categoria === 'films') {
                content += `
                    <p><strong>Episódio</strong> <span>${item.episode_id}</span></p>
                    <p><strong>Diretor</strong> <span>${item.director}</span></p>
                    <p><strong>Lançamento</strong> <span>${item.release_date}</span></p>
                `;
            }

            return content + '</div>';
        }

        function createPagination(data) {
            let html = '<div class="pagination">';
            if (data.pagina_atual > 1) html += `<button onclick="goToPage(${data.pagina_atual - 1})">ANTERIOR</button>`;
            if (data.pagina_atual < data.total_paginas) html += `<button onclick="goToPage(${data.pagina_atual + 1})">PRÓXIMA</button>`;
            return html + '</div>';
        }

        function goToPage(page) {
            currentPage = page;
            search();
        }
    </script>
</body>
</html>